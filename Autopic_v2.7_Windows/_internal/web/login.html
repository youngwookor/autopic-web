<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Autopic - ë¡œê·¸ì¸</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800;900&display=swap');
        * { font-family: 'Inter', 'Malgun Gothic', sans-serif; box-sizing: border-box; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }
        @keyframes pulse { 0%, 100% { opacity: 1; } 50% { opacity: 0.7; } }
        @keyframes spin { from { transform: rotate(0deg); } to { transform: rotate(360deg); } }
        .animate-fade-in { animation: fadeIn 0.5s ease-out; }
        .animate-pulse-slow { animation: pulse 2s ease-in-out infinite; }
        .animate-spin { animation: spin 1s linear infinite; }
        .input-focus:focus { box-shadow: 0 0 0 3px rgba(163, 230, 53, 0.3); }
        body {
            background: linear-gradient(135deg, #18181b 0%, #27272a 50%, #18181b 100%);
            min-height: 100vh;
        }
    </style>
</head>
<body class="flex items-center justify-center p-4">
    <div class="w-full max-w-md animate-fade-in">
        <!-- ë¡œê³  ì˜ì—­ -->
        <div class="text-center mb-8">
            <div class="inline-flex items-center justify-center w-20 h-20 bg-zinc-800 rounded-3xl mb-6 shadow-2xl border border-zinc-700">
                <svg viewBox="0 0 24 24" class="w-10 h-10 text-lime-400" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M14.5 4h-5L7 7H4a2 2 0 0 0-2 2v9a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-3l-2.5-3z"/>
                    <circle cx="12" cy="13" r="3"/>
                </svg>
            </div>
            <h1 class="text-3xl font-black text-white tracking-tight mb-2">Autopic</h1>
            <p class="text-zinc-400 text-sm">AI ìƒí’ˆ ì´ë¯¸ì§€ ìë™ ìƒì„±</p>
        </div>

        <!-- ë¡œê·¸ì¸ ì¹´ë“œ -->
        <div class="bg-zinc-900 rounded-3xl p-8 shadow-2xl border border-zinc-800">
            <!-- ì—ëŸ¬ ë©”ì‹œì§€ -->
            <div id="errorMessage" class="hidden mb-6 p-4 bg-red-500/10 border border-red-500/30 rounded-xl">
                <p class="text-red-400 text-sm font-medium text-center" id="errorText"></p>
            </div>

            <!-- API í‚¤ ì…ë ¥ -->
            <div class="mb-6">
                <label class="block text-xs font-bold text-zinc-400 uppercase tracking-wider mb-3">API í‚¤</label>
                <div class="relative">
                    <input 
                        type="password" 
                        id="apiKeyInput" 
                        class="input-focus w-full bg-zinc-800 border-2 border-zinc-700 rounded-xl px-4 py-4 text-white placeholder-zinc-500 text-sm transition-all focus:border-lime-400 focus:outline-none"
                        placeholder="ap_xxxx... í˜•ì‹ì˜ API í‚¤ ì…ë ¥"
                        autocomplete="off"
                    >
                    <button 
                        onclick="toggleKeyVisibility()" 
                        class="absolute right-3 top-1/2 -translate-y-1/2 text-zinc-500 hover:text-zinc-300 transition-colors p-1"
                    >
                        <svg id="eyeIcon" class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"/>
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"/>
                        </svg>
                        <svg id="eyeOffIcon" class="w-5 h-5 hidden" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13.875 18.825A10.05 10.05 0 0112 19c-4.478 0-8.268-2.943-9.543-7a9.97 9.97 0 011.563-3.029m5.858.908a3 3 0 114.243 4.243M9.878 9.878l4.242 4.242M9.88 9.88l-3.29-3.29m7.532 7.532l3.29 3.29M3 3l3.59 3.59m0 0A9.953 9.953 0 0112 5c4.478 0 8.268 2.943 9.543 7a10.025 10.025 0 01-4.132 5.411m0 0L21 21"/>
                        </svg>
                    </button>
                </div>
            </div>

            <!-- ë¡œê·¸ì¸ ë²„íŠ¼ -->
            <button 
                onclick="login()" 
                id="loginBtn"
                class="w-full py-4 bg-lime-400 text-zinc-900 rounded-xl font-black text-sm hover:bg-lime-300 transition-all flex items-center justify-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed"
            >
                <span id="loginBtnIcon">ğŸ”—</span>
                <span id="loginBtnText">ì—°ë™í•˜ê¸°</span>
                <div id="loginBtnLoading" class="hidden">
                    <svg class="w-5 h-5 animate-spin" fill="none" viewBox="0 0 24 24">
                        <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
                        <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4z"></path>
                    </svg>
                </div>
            </button>

            <!-- êµ¬ë¶„ì„  -->
            <div class="flex items-center my-6">
                <div class="flex-1 h-px bg-zinc-700"></div>
                <span class="px-4 text-xs text-zinc-500">API í‚¤ê°€ ì—†ìœ¼ì‹ ê°€ìš”?</span>
                <div class="flex-1 h-px bg-zinc-700"></div>
            </div>

            <!-- ë°œê¸‰ ì•ˆë‚´ -->
            <div class="bg-zinc-800/50 rounded-xl p-5 border border-zinc-700/50">
                <h3 class="font-bold text-white text-sm mb-3 flex items-center gap-2">
                    <span class="text-lime-400">ğŸ’¡</span> API í‚¤ ë°œê¸‰ ë°©ë²•
                </h3>
                <ol class="space-y-2 text-sm text-zinc-400">
                    <li class="flex items-start gap-2">
                        <span class="w-5 h-5 bg-zinc-700 rounded-full flex items-center justify-center text-xs text-zinc-300 shrink-0 mt-0.5">1</span>
                        <span><a href="https://autopic-web.vercel.app" target="_blank" class="text-lime-400 hover:underline font-medium">autopic-web.vercel.app</a> ì ‘ì†</span>
                    </li>
                    <li class="flex items-start gap-2">
                        <span class="w-5 h-5 bg-zinc-700 rounded-full flex items-center justify-center text-xs text-zinc-300 shrink-0 mt-0.5">2</span>
                        <span>íšŒì›ê°€ì… í›„ í¬ë ˆë”§ ì¶©ì „</span>
                    </li>
                    <li class="flex items-start gap-2">
                        <span class="w-5 h-5 bg-zinc-700 rounded-full flex items-center justify-center text-xs text-zinc-300 shrink-0 mt-0.5">3</span>
                        <span>ë§ˆì´í˜ì´ì§€ â†’ API í‚¤ ê´€ë¦¬</span>
                    </li>
                    <li class="flex items-start gap-2">
                        <span class="w-5 h-5 bg-zinc-700 rounded-full flex items-center justify-center text-xs text-zinc-300 shrink-0 mt-0.5">4</span>
                        <span>"ìƒˆ API í‚¤ ìƒì„±" í´ë¦­ í›„ ë³µì‚¬</span>
                    </li>
                </ol>
            </div>
        </div>

        <!-- í‘¸í„° -->
        <p class="text-center text-zinc-600 text-xs mt-6">
            Autopic Desktop v2.7 Â· Powered by AI
        </p>
    </div>

    <script>
        let isKeyVisible = false;

        // Enter í‚¤ë¡œ ë¡œê·¸ì¸
        document.getElementById('apiKeyInput').addEventListener('keypress', function(e) {
            if (e.key === 'Enter') login();
        });

        // í¬ì»¤ìŠ¤ ìë™ ì„¤ì •
        document.addEventListener('DOMContentLoaded', function() {
            document.getElementById('apiKeyInput').focus();
        });

        function toggleKeyVisibility() {
            isKeyVisible = !isKeyVisible;
            const input = document.getElementById('apiKeyInput');
            const eyeIcon = document.getElementById('eyeIcon');
            const eyeOffIcon = document.getElementById('eyeOffIcon');
            
            input.type = isKeyVisible ? 'text' : 'password';
            eyeIcon.classList.toggle('hidden', isKeyVisible);
            eyeOffIcon.classList.toggle('hidden', !isKeyVisible);
        }

        function showError(message) {
            const errorEl = document.getElementById('errorMessage');
            const errorText = document.getElementById('errorText');
            errorText.textContent = message;
            errorEl.classList.remove('hidden');
        }

        function hideError() {
            document.getElementById('errorMessage').classList.add('hidden');
        }

        function setLoading(loading) {
            const btn = document.getElementById('loginBtn');
            const icon = document.getElementById('loginBtnIcon');
            const text = document.getElementById('loginBtnText');
            const loadingEl = document.getElementById('loginBtnLoading');
            
            btn.disabled = loading;
            icon.classList.toggle('hidden', loading);
            text.textContent = loading ? 'ì—°ë™ ì¤‘...' : 'ì—°ë™í•˜ê¸°';
            loadingEl.classList.toggle('hidden', !loading);
        }

        async function login() {
            const apiKey = document.getElementById('apiKeyInput').value.trim();
            
            hideError();
            
            if (!apiKey) {
                showError('API í‚¤ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”');
                return;
            }
            
            if (!apiKey.startsWith('ap_')) {
                showError('ì˜¬ë°”ë¥¸ API í‚¤ í˜•ì‹ì´ ì•„ë‹™ë‹ˆë‹¤ (ap_ë¡œ ì‹œì‘í•´ì•¼ í•©ë‹ˆë‹¤)');
                return;
            }
            
            setLoading(true);
            
            try {
                const result = await pywebview.api.login_with_api_key(apiKey);
                
                if (result.success) {
                    // ë¡œê·¸ì¸ ì„±ê³µ - í¬ë ˆë”§ê³¼ í‚¤ ì´ë¦„ì„ URL íŒŒë¼ë¯¸í„°ë¡œ ì „ë‹¬
                    const params = new URLSearchParams();
                    params.set('credits', result.credits || 0);
                    params.set('keyName', result.key_name || '');
                    params.set('loggedIn', 'true');
                    window.location.href = 'index.html?' + params.toString();
                } else {
                    showError(result.error || 'ì—°ë™ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤');
                }
            } catch (e) {
                showError('ì„œë²„ ì—°ê²°ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤: ' + e);
            } finally {
                setLoading(false);
            }
        }
    </script>
</body>
</html>
